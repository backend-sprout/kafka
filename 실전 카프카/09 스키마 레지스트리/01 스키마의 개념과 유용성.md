# 스키마의 개념과 유용성

## RDBMS의 스키마

RDB의 경우 스키마가 미리 정의되어 있고,   
RDB의 데이터를 추가하기 위해서는 반드시 사전에 정의된 스키마의 형태로 데이터를 입력해야한다.    
**사전에 정의된 스키마의 내용과 다른 데이터를 추가하려고 시도하면 작업은 실패한다.**    
(CHAR 타입을 INT로 넣는다던지 등등)   

## 카프카에서의 스키마 개요 

카프카에서도 스키마를 사용한다.    
단 한명의 사용자만 카프카의 토픽에 읽고 쓰기를 실행한다면 스키마가 정의되어 있지 않더라도 별다른 이슈가 없다.   
   
하지만, **중앙 데이터 파이프라인 역할을 하는 카프카**에서는      
단 한명의 사용자가 단 하나의 토픽에만 접근해 읽고 쓰는 것이 아니라 수많은 사용자가 수많은 토픽을 이용한다.        
그리고 그 토픽에는 다수의 애플리케이션들이 접근할 것이다.    

**따라서 만에 하나 누군가의 실수로 사전에 정의하지 않은 형태의 데이터를 해당 토픽으로 보내버리기라도 한다면**    
**그와 연결된 모든 시스템이 영향을 받게될 것이고 이는 매우 심각한 문제로 이어질 수 있다.**     

## 대규모 조직에서의 스키마

카프카의 데이터 흐름은 대부분 브로드캐스트 방식이다.         
**즉, 카프카는 데이터를 전송하는 프로듀서를 일방적으로 신뢰할 수 밖에 없다.**       
따라서 프로듀서 관리자는 카프카 토픽의 데이터를 컨슘하는 관리자에게 반드시 데이터 구조를 설명해야한다.   

데이터를 컨슘하는 관리자가 한명이면 이를 설명하는 것은 쉽겠지만    
대상 부서가 많고 관리자도 자주 바뀐다면 그때마다 데이터 구조를 설명하는 일은 쉬운 것이 아니다.    
(현재 내가 속한 회사의 상황은 아니지만, 더 크고 인프라를 별도로 관리하는 회사의 경우는 어려울듯..)    
**이와 같이 데이터를 컨슘하는 여러 부서에게 그 데이터에 대한 정확한 정의와 의미를 알려주는 역할을 하는 것이 스키마다.**  

## 모델링이나 포맷 변경에서의 스키마 

기업에서는 비즈니스 변화 등에 따라 모델링이나 데이터 포맷이 변경되기도 한다. 
이때 새로운 필드 추가, 삭제 이름 변경등의 이벤트가 이루어지는데    
이 같은 이벤트가 발생하면 관련된 내용을 문서에 남기고 이를 전파해야한다.    
**즉, 커뮤니케이션의 어려움이 발생하며 이는 조직 전체의 데이터 흐름에서 가장 어려운 애로사항이다.**   
(앞서 정의했던 문제가 다 발생)  

## 데이터 파싱시 에러에서의 스키마 
수많은 데이터 엔지니어나 데이터 분석가들이    
데이터를 분석, 적재하는 작업보다 데이터 파싱에 더 많은 시간을 보내고 있다는 현실이다.   
누군가에 의해 전송된, 데이터 형식을 벗어난 데이터 필드를 찾아 파싱하고    
**에러를 처리하는 데 기업 내 고급 인력들이 수많은 시간을 허비하는 것은 매우 안타까운 일이다.**      

## 그래서 카프카의 스키마는..  

RDBMS와 마찬가지로 카프카는 위와 같은 문제들을 해결하기 위해 정의한다.(일종의 문서화 같은)   
허나, 데이터를 처리하기 앞ㅅ허 스키마를 정의하는 작업을 해야하므로 이에 따른 리소스(시간과 노력)가 든다.     
  
JSON 처럼 간단하게 정의하고 사용하는게 아니라, 데이터 타입과 의미가 무엇인지 주석을 달아 상세하게 표현해야한다.      
하지만, 스키마를 정의해두면 트러블 슈팅 감소, 용이한 데이터 포맷 확인, 데이터 스키마 관련 커뮤니케이션 감소등 얻을 수 있는 이점들이 많다.   
(권장사항)  












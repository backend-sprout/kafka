# 주키퍼 의존성이 있는 카프카 롤링 업그레이드

카프카 `2.1` -> `2.6`으로 올리는 작업을 실습해볼 예정이다.      

## 2.1 버전 
### 토픽 생성 
이전 실습 처럼 토픽을 생성하는 명령어를 입력해본다.  

```shell
/usr/local/kafka/bin/kafka-topics.sh   
--bootstrap-server peter-kafka01.foo.bar:9092    
--create --topic peter-version2-1      
--partitions 1       
--replication factor 3     
```  

하지만, 카프카 2.1 에서는 `--bootstrap-server`를 지원하지 않기에 에러가 발생한다.    
카프카의 버전이 변경되면서 명령어의 옵션이 변경되거나 삭제되는 경우가 있으므로,      
자동화 스크립트 또는 프로그래밍 코드등에서 작성한 명령어들이 잘 동작하는지를 반드시 확인해야한다.   

아무튼, `--bootstrap-server` 를 사용할 수 없으므로 주키퍼를 이용해 생성해보도록 하자.  
 
```shell 
/usr/local/kafka/bin/kafka-topics.sh 
--zookeeper peter-zk01.foo.bar 
--create 
--topic peter-version2-1 
--partitions 1 
--replication-factor 3
```

주키퍼를 이용해서 토픽을 생성했다.  

### 프로듀서 발송 

```shell
/usr/local/kafka/bin/kafka-console-producer.sh   
--broker-list peter-kafka01.foo.bar:9092   
--topic peter-version2-1
--from-beginning --group peter-consumer 
```

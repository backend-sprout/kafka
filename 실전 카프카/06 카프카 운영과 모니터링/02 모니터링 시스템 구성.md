# 모니터링 시스템 구성
  
잘 갖춰진 모니터링 도구를 사용해 관리자가 카프카의 현재 상태를 정확하게 파악한다면,     
미랴에 일어날 이슈나 문제를 사전에 예측해 미리 조사할 수 있으며 장애도 빠르게 감지해 신속한 장애 처리가 가능할 것이다.    
이제부터, 오픈소스 기반의 카프카 모니터링 시스템을 직접 구성해보면서 카프카를 모니터링하는 방법을 살펴보자.  
     
카프카를 모니터링하는 방법은 여러가지가 있지만,           
그 중에서 대표적인 모니터링은 **애플리케이션 로그 분석**과 **JMX**를 이용해 브로커들의 매트릭 정보를 확인하는 방법이다.           
이제부터 카프카 애플리케이션 로그의 레벨과 이를 변경하는 방법을 알아보겠습니다.          

## 애플리케이션으로서 카프카의 로그 관리와 분석  
          
카프카는 **카프카 애플리케이션에서 발생하는 모든 로그를 브로커의 로컬 디스크에 기록하고 있다.**          
관리자는 이 **로그를 활용해 카프카의 현재 상태나 이상 징후등을 발견하거나 이상 증상 발생시 원인을 찾는다.**       
지금부터 카프카에서 제공하는 카프카 애플리케이션 로그란 무엇인지 알아보자   
   
카프카는 애플리케이션 로그 관리를 위해 자바 기반의 로깅 유틸리티인 `아파치 log4j` 를 이용한다.   
log4j는 애플리케이션의 레벨별로 로깅이 가능하며, 관리자는 로그의 레벨을 보고 상황의 심각성 등을 유추할 수 있다.   
 
|로그 레벨|설명|  
|------|---|  
|TRACE|DEBUG 보다 상세한 로그를 기록한다.|  
|DEBUG|내부 애플리케이션 상황에 대한 로그를 기록함(INFO 로그 레벨보다 상세한 로그 기록)|   
|INFO||로그 레벨의 기본값이며, 일반적인 정보 수준의 로그를 기록한다.|  
|WARN|INFO 로그 레벨보다 높은 개념으로, 경고 수준의 로그를 기록함|   
|ERROR|경고 수준을 넘어 런타임 에러나 예상하지 못한 에러 로그를 기록한다.|  
|FATAL|로그 레벨 중 최종 단계이며, 심각한 오류로 인한 애플리케이션 중지 등의 로그를 기록한다.|    

카프카 애플리케이션에는 여섯 가지의 로그 레벨이 있으며 이 중 INFO 로그 레벨이 카프카 애플리케이션 로그의 기본값이다.    
간혹 카프카의 이슈가 발생하면 관리자는 INFO 수준보다 상세한 로그를 확인하고 싶을 수 있는데 이런 경우 로그의 레벨 변경이 필요하다.     
    
관리자가 로그 레벨을 조정할 수 있을까?         
카프카에서 제공하는 log4j 의 설정 변경을 통해 관리자는 언제든지 로그 레벨을 변경할 수 있다.      
그럼 브로커에서 직접 로그 레벨을 변경한 후 어떻게 변화하는지 실습을 통해 알아보자.     
  
### 실습   
   
브로커 서버 중 peter-kafka01에 접속한 후 다음과 같이 리눅의 cat 명령어를 이용해 log4 파일 내용을 확인하다.  
  
```shell 
cat /usr/local/kafka/config/log4j.properties
```
```properties
... 중략 
log4j.logger.kafka=INFO
log4j.logger.org.apache.kafka=INFO.  
... 중략 
```





    




